import cv2
import os
import numpy as np

def main():

    kps2d = np.array([[743.20697021, 580.30181885,   1.        ],
        [737.36425781, 594.02532959,   1.        ],
        [753.28991699, 593.3303833 ,   1.        ],
        [744.3972168 , 565.92321777,   1.        ],
        [704.01763916, 619.74078369,   1.        ],
        [756.39501953, 635.73272705,   1.        ],
        [744.85351562, 548.64349365,   1.        ],
        [722.13586426, 668.10357666,   1.        ],
        [764.72460938, 688.8692627 ,   1.        ],
        [744.24841309, 540.1550293 ,   1.        ]])

    kps3d = np.array([[-1.70768964e+00,  3.17459553e-01,  9.12188816e+00,
            1.00000000e+00],
        [-1.74542880e+00,  4.23549652e-01,  9.07879639e+00,
            1.00000000e+00],
        [-1.63456345e+00,  4.21710700e-01,  9.15716743e+00,
            1.00000000e+00],
        [-1.69063628e+00,  2.03275323e-01,  9.08065033e+00,
            1.00000000e+00],
        [-2.04099011e+00,  6.35786593e-01,  9.23319435e+00,
            1.00000000e+00],
        [-1.63573825e+00,  7.69105434e-01,  9.30350399e+00,
            1.00000000e+00],
        [-1.68367076e+00,  6.76413178e-02,  9.06241703e+00,
            1.00000000e+00],
        [-1.87235999e+00,  1.00837398e+00,  9.11552143e+00,
            1.00000000e+00],
        [-1.56375468e+00,  1.19213676e+00,  9.27346706e+00,
            1.00000000e+00],
        [-1.68993425e+00,  1.21444464e-03,  9.07061863e+00,
            1.00000000e+00]])

    kps2d = kps2d[:, :2]
    kps3d = kps3d[:, :3]

    focal_length = (1158.0337, 1158.0337)
    camera_center = (960, 540) 

    # create camera matrix
    cameraMatrix = np.zeros((3,3))
    cameraMatrix[0,0] = focal_length[0]
    cameraMatrix[1,1] = focal_length[1]
    cameraMatrix[0,2] = camera_center[0]
    cameraMatrix[1,2] = camera_center[1] 

    objPoints = np.array(kps3d).reshape(-1, 3)
    imgPoints = np.array(kps2d).reshape(-1, 2)

    retval, rvec, tvec = cv2.solvePnP(objPoints, imgPoints, cameraMatrix, distCoeffs=None)

    print(rvec, tvec)

if __name__ == '__main__':
    main()